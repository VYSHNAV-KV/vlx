<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Corona Admin</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/mdi/css/materialdesignicons.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/css/vendor.bundle.base.css' %}">
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/jvectormap/jquery-jvectormap.css' %}">
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/flag-icon-css/css/flag-icon.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/owl-carousel-2/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'admin/assets/vendors/owl-carousel-2/owl.theme.default.min.css' %}">
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="{% static 'admin/assets/css/style.css' %}">
    <!-- End layout styles -->
    <link rel="shortcut icon" href="{% static 'admin/assets/images/favicon.png' %}" />
  </head>
<body>
<div class="main-panel">
          <div class="content-wrapper">
            <div style="background-color:#98FB98">
              <div class="col-12 grid-margin stretch-card">
                <div >
                  <div class="card-body py-0 px-0 px-sm-3">
                    <div style="background-color:#98FB98">
                      <div class="col-4 col-sm-3 col-xl-2">
                        <img src="assets/images/dashboard/Group126@2x.png" class="gradient-corona-img img-fluid" alt="">
                      </div>

                    </div>
                  </div>
                </div>
              </div>
            </div>
    <div class="col-12 grid-margin stretch-card" style="border: 3px solid #98FB98;">
        <div class="card">
            <div class="card-body">
                <h3 class="card-title">Vehicle Details</h3>
                <form class="forms-sample" method="post" action="{% url 'save_dataform' %}" enctype="multipart/form-data">
                    {% csrf_token %}

                    <!-- Category Selection -->
                    <div class="form-group">
                    <label>What you need to sell ?</label>
                    <select id="category-select" name="Categoryname" onchange="adjustFormFields()" class="form-control" >
                        <option>Choose Category</option>>
                        {% for cat in categories %}
                            <option value="{{ cat.Categoryname }}" {% if cat.Categoryname == selected_category %}selected{% endif %}>
                                {{ cat.Categoryname }}
                            </option>
                        {% endfor %}
                    </select>
                    </div>
                    <div class="form-group">
    <label>Select your preferred subcategory</label>
    <select id="subcategory-select" class="form-control" name="Subcategoryname">
        <option value="">Choose Subcategory</option>
    </select>
</div>

                    <!-- Dynamic Fields Container -->
                    <div id="dynamic-fields">
                        <!-- Common Fields -->
                        <div class="form-group">
                            <label>Product Name</label>
                            <input type="text" class="form-control" placeholder="Product Name" name="Productname">
                        </div>
                        <div class="form-group">
                            <label>Owner Name</label>
                            <input type="text" class="form-control" placeholder="Owner Name" name="Ownername">
                        </div>

                        <div class="form-group">
                            <label>Price</label>
                            <input type="number" class="form-control" placeholder="Price" name="Price">
                        </div>
                        <div class="form-group">
                            <label>Mobile</label>
                            <input type="number" class="form-control" placeholder="Mobile" name="Mobile">
                        </div>
                        <div class="form-group">
                            <label>Location</label>
                            <input type="text" class="form-control" placeholder="Location" name="Location">
                        </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea class="form-control" rows="4" placeholder="Desciption" name="Description"></textarea>
                        </div>

                        <div>
                            <label>Upload Images</label><br>


                            <div class="form-group">
                                <input type="file" class="form-control file-upload-info" placeholder="Upload Image" name="Vehicleimage1">
                            </div>
                            <div class="form-group">
                                <input type="file" class="form-control file-upload-info" placeholder="Upload Image" name="Vehicleimage2">
                            </div>
                            <div class="form-group">
                                <input type="file" class="form-control file-upload-info" placeholder="Upload Image" name="Vehicleimage3">
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" class="btn btn-primary mr-2" style="width:150px">Submit</button>
                    <button class="btn btn-dark">Cancel</button>
                </form>
            </div>
        </div>
    </div>
     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $('#category-select').change(function () {
            const category = $(this).val();
            const subcategorySelect = $('#subcategory-select');

            // Clear and reset subcategory options
            subcategorySelect.empty();
            subcategorySelect.append('<option value="">Choose Subcategory</option>');

            if (category) {
                $.ajax({
                    url: "",  // Keep the same URL
                    data: {
                        'category': category
                    },
                    success: function (data) {
                        data.forEach(function (subcategory) {
                            subcategorySelect.append(
                                `<option value="${subcategory.Subcategoryname}">${subcategory.Subcategoryname}</option>`
                            );
                        });
                    },
                    error: function () {
                        alert('Failed to fetch subcategories. Please try again.');
                    }
                });
            }
        });
    });
</script>

    <script src="{% static 'admin/assets/vendors/js/vendor.bundle.base.js' %}"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <script src="{% static 'admin/assets/vendors/chart.js/Chart.min.js' %}"></script>
    <script src="{% static 'admin/assets/vendors/progressbar.js/progressbar.min.js' %}"></script>
    <script src="{% static 'admin/assets/vendors/jvectormap/jquery-jvectormap.min.js' %}"></script>
    <script src="{% static 'admin/assets/vendors/jvectormap/jquery-jvectormap-world-mill-en.js' %}"></script>
    <script src="{% static 'admin/assets/vendors/owl-carousel-2/owl.carousel.min.js' %}"></script>
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="{% static 'admin/assets/js/off-canvas.js' %}"></script>
    <script src="{% static 'admin/assets/js/hoverable-collapse.js' %}"></script>
    <script src="{% static 'admin/assets/js/misc.js' %}"></script>
    <script src="{% static 'admin/assets/js/settings.js' %}"></script>
    <script src="{% static 'admin/assets/js/todolist.js' %}"></script>
    <!-- endinject -->
    <!-- Custom js for this page -->
    <script src="{% static 'admin/assets/js/dashboard.js' %}"></script>

    <script>
        function adjustFormFields() {
            const category = document.getElementById('category-select').value;
            const dynamicFields = document.getElementById('dynamic-fields');
            dynamicFields.innerHTML = '';

            // Common fields (always shown)
            dynamicFields.innerHTML += `
                <div class="form-group">
                    <label>Product Name</label>
                    <input type="text" class="form-control" placeholder="Vehicle Name" name="Productname">
                </div>
                <div class="form-group">
                    <label>Owner Name</label>
                    <input type="text" class="form-control" placeholder="Vehicle Model" name="Ownername">
                </div>
                <div class="form-group">
                    <label>Asking Price</label>
                    <input type="number" class="form-control" placeholder="Price" name="Price">
                </div>
                <div class="form-group">
                    <label>Mobile</label>
                    <input type="number" class="form-control" placeholder="Mobile" name="Mobile">
                </div>
                <div class="form-group">
                    <label>Location</label>
                    <input type="text" class="form-control" placeholder="Location" name="Location">
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea class="form-control" rows="4" placeholder="Description" name="Description"></textarea>
                </div>
<!--                <div class="form-group">-->
<!--                    <label>Registration</label>-->
<!--                    <input type="text" class="form-control" placeholder="Registration" name="Registration">-->
<!--                </div>-->
<!--                <div class="form-group">-->
<!--                    <label>Company</label>-->
<!--                    <input type="text" class="form-control" placeholder="Company" name="Company">-->
<!--                </div>-->
                <div>
                    <label>Upload Images</label><br>
                    <div class="form-group">
                        <input type="file" class="form-control file-upload-info" placeholder="Upload Image" name="Vehicleimage1">
                    </div>
                    <div class="form-group">
                        <input type="file" class="form-control file-upload-info" placeholder="Upload Image" name="Vehicleimage2">
                    </div>
                    <div class="form-group">
                        <input type="file" class="form-control file-upload-info" placeholder="Upload Image" name="Vehicleimage3">
                    </div>
                </div>
            `;

            // Add category-specific fields
            if (category === 'Cars') {
                dynamicFields.innerHTML += `
                    <div class="form-group">
                        <label>Fuel Type</label>
                        <input type="text" name="fuel_type" class="form-control" placeholder="Fuel Type">
                    </div>
                    <div class="form-group">
                        <label>Mileage</label>
                        <input type="text" name="mileage" class="form-control" placeholder="Mileage">
                    </div>
                `;
            }
            else if (category === 'Bikes') {
                dynamicFields.innerHTML += `
                    <div class="form-group">
                        <label>Engine CC</label>
                        <input type="text" name="engine_cc" class="form-control" placeholder="Engine CC">
                    </div>
                `;
            }
            else if (category === 'Properties') {
                dynamicFields.innerHTML += `
                    <div class="form-group">
                        <label>Hello</label>
                        <input type="text" name="engine_cc" class="form-control" placeholder="Engine CC">
                    </div>
                `;
            }
        }

        // Trigger on page load to show fields based on the initial selected category
        window.onload = function() {
            adjustFormFields();
        };
    </script>
</body>
</html>

